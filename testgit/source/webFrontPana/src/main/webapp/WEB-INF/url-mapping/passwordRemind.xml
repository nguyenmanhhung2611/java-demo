<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd">

	<!-- パスワードリマインダー処理 -->
	<bean id="pwRemindCommand"
		class="jp.co.transcosmos.dm3.webFront.passwordRemind.command.PwRemindCommand"
		scope="prototype">
		<property name="mypageUserManage" ref="mypageUserManager" />
		<property name="sendPasswordRemind" ref="sendPasswordRemind"/>
		<property name="commonParameters" ref="commonParameters"/>

	</bean>

	<!-- 新パスワード入力処理 -->
	<bean id="pwNewCommand"
		class="jp.co.transcosmos.dm3.webFront.passwordRemind.command.PwNewInitCommand"
		scope="prototype">
		<property name="panaMypageUserManager" ref="panaMypageUserManager" />

	</bean>

	<!-- 新パスワード変更処理 -->
	<bean id="pwNewResultCommand"
		class="jp.co.transcosmos.dm3.webFront.passwordRemind.command.PwNewResultCommand"
		scope="prototype">
		<property name="mypageUserManage" ref="mypageUserManager" />
		<property name="panaMypageUserManager" ref="panaMypageUserManager" />
		<property name="commonParameters" ref="commonParameters"/>
		<property name="sendPasswordResult" ref="sendPasswordResult"/>
	</bean>

	<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMappingList">
		<property name="commandURLMapper" ref="commandURLMapper" />
		<property name="mappings">
			<list>

				<!-- ログイン画面 （Panasonic 版用ログインページを設定） -->
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/pw/forgot/input/" />
					<property name="defaultViewName"
						value="/WEB-INF/jsp/front/account/PasswordRemindInit.jsp" />
				</bean>

				<!-- CSRF 対策用 token のチェックフィルター -->
<!-- フィルターの実行タイミングが固定できないので、global.xml へ移動
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/pw/forgot/result/" />
					<property name="defaultCommandName" value="csrfChkFilter"/>
					<property name="filter" value="true"/>
				</bean>
-->

				<!-- ログイン処理 （Panasonic 版用ログインページを設定） -->
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/pw/forgot/result/" />
					<property name="defaultCommandName" value="pwRemindCommand" />
					<property name="defaultViewName"
						value="/WEB-INF/jsp/front/account/PasswordRemindResult.jsp" />
					<property name="namedViews">
						<props>
							<prop key="validFail">/WEB-INF/jsp/front/account/PasswordRemindInit.jsp
							</prop>
						</props>
					</property>
				</bean>

				<!-- 新パスワード入力処理 -->
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/pw/new/input/###remindId###/" />
					<property name="defaultCommandName" value="pwNewCommand" />
					<property name="defaultViewName"
						value="/WEB-INF/jsp/front/account/NewPasswordInit.jsp" />
					<property name="namedViews">
						<props>
							<prop key="error">/WEB-INF/jsp/front/account/NewPasswordError.jsp
							</prop>
							<prop key="404">/WEB-INF/jsp/front/common/404.jsp</prop>
						</props>
					</property>

				</bean>

				<!-- CSRF 対策用 token のチェックフィルター -->
<!-- フィルターの実行タイミングが固定できないので、global.xml へ移動
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/pw/new/result/###remindId###/" />
					<property name="defaultCommandName" value="csrfChkFilter"/>
					<property name="filter" value="true"/>
				</bean>
-->

				<!-- 新パスワード変更処理 -->
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/pw/new/result/###remindId###/" />
					<property name="defaultCommandName" value="pwNewResultCommand" />
					<property name="defaultViewName"
						value="/WEB-INF/jsp/front/account/NewPasswordResult.jsp" />
					<property name="namedViews">
						<props>
							<prop key="validFail">/WEB-INF/jsp/front/account/NewPasswordInit.jsp
							</prop>
							<prop key="404">/WEB-INF/jsp/front/common/404.jsp</prop>
						</props>
					</property>

				</bean>

			</list>
		</property>
	</bean>

</beans>
