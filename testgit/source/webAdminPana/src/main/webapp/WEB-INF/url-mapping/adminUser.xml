<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd">

  <bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="classpath:site.properties" />
  </bean>



  <!-- CSV 出力設定 -->
  <bean id="adminUserCsvConverter" class="jp.co.transcosmos.dm3.webAdmin.userManage.CsvConverter">
    <property name="codeLookupManager" ref="codeLookupManager"/>
    <property name="adminLoginInfoDAO" ref="adminLoginInfoDAO"/>
  </bean>

  <bean id="adminUserCsvConfig" class="jp.co.transcosmos.dm3.csv.CsvConfig">
    <property name="fileName" value="kanriuser_###yyyyMMdd###"/>
    <property name="headerColumns">
      <list>
        <value>管理ユーザ番号</value>
        <value>ログインID</value>
        <value>ユーザ名</value>
        <value>メールアドレス</value>
        <value>最終ログイン日</value>
        <value>権限</value>
        <value>アカウントロック状態</value>
		<value>新規登録日</value>
		<value>新規登録者</value>
		<value>最終更新日</value>
		<value>最終更新者</value>
      </list>
    </property>
    <property name="dbColumns">
      <list>
        <value>adminLoginInfo.adminUserId</value>
        <value>adminLoginInfo.loginId</value>
        <value>adminLoginInfo.userName</value>
        <value>adminLoginInfo.email</value>
        <value>adminLoginInfo.lastLogin</value>
        <value>adminRoleInfo.roleId</value>
        <value>adminLoginInfo.failCnt</value>
        <value>adminLoginInfo.insDate</value>
        <value>adminLoginInfo.insUserId</value>
        <value>adminLoginInfo.updDate</value>
        <value>adminLoginInfo.updUserId</value>
      </list>
    </property>
    <property name="csvValueConverter" ref="adminUserCsvConverter"/>
    <property name="useBOM" value="true"/>
  </bean>

  <!--
  	管理者用ランダムパスワード生成クラス
  	デフォルト設定では、８桁の大小英字、数字を含む文字列を生成する。
  	パスワード強度の変更等により、記号文字の生成を強制する場合はこのクラスのプロパティを変更する事。
  -->
  <bean id="adminPwdCreatetor" class="jp.co.transcosmos.dm3.core.util.CreatePassword">
    <property name="signList" value="${admin.usePwdMarks}" />
  </bean>



  <!-- 管理ユーザー検索・一覧画面 -->
  <bean id="adminUserListCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserListCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="rowsPerPage" value="50"/>
  </bean>

  <!-- CSV 出力 -->
  <bean id="adminUserCsvCommand" class="jp.co.transcosmos.dm3.webAdmin.userManage.command.PanaUserCsvCommand" scope="prototype">
    <property name="logging" ref="adminLogging"/>
    <property name="userManager" ref="adminUserManager"/>
  </bean>

  <!-- 管理ユーザー新規登録入力画面 -->
  <bean id="adminUserAddInputCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserInputCommand" scope="prototype">
    <property name="mode" value="insert"/>
  </bean>

  <!-- 管理ユーザー新規登録入力確認画面 -->
  <bean id="adminUserAddConfirmCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserConfirmCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="mode" value="insert"/>
  </bean>

  <!-- 管理ユーザー新規入力完了画面 -->
  <bean id="adminUserAddCompCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserCompCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="mode" value="insert"/>
    <property name="useUserIdValidation" value="false"/>
    <property name="sendAdminPasswordTemplate" ref="sendNewAdminUserTemplate"/>
  </bean>

  <!-- 管理ユーザー変更入力画面 -->
  <bean id="adminUserUpdInputCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserInputCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="mode" value="update"/>
  </bean>

  <!-- 管理ユーザー変更入力確認画面 -->
  <bean id="adminUserUpdConfirmCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserConfirmCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="mode" value="update"/>
  </bean>

  <!-- 管理ユーザー変更完了画面 -->
  <bean id="adminUserUpdCompCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserCompCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="mode" value="update"/>
    <property name="sendAdminPasswordTemplate" ref="sendAdminPasswordTemplate"/>
  </bean>

  <!-- 管理ユーザー削除完了画面 -->
  <bean id="adminUserDelCompCommand" class="jp.co.transcosmos.dm3.webAdmin.userManage.command.PanaUserCompCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="mode" value="delete"/>
    <property name="useValidation" value="false"/>
    <property name="rowsPerPage" value="50"/>
  </bean>

  <!-- 管理ユーザーロック解除完了画面 -->
  <bean id="adminUserUnlockCommand" class="jp.co.transcosmos.dm3.adminCore.userManage.command.UserCompCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager"/>
    <property name="mode" value="unlock"/>
    <property name="useValidation" value="false"/>
  </bean>

  <!-- ランダムパスワード生成　（Web API） -->
  <bean id="adminRandomPwdCommand" class="jp.co.transcosmos.dm3.core.command.RandomPwdCommand" scope="prototype">
    <property name="createPassword" ref="adminPwdCreatetor" />
  </bean>

  <!-- 管理ユーザーパスワード変更入力画面 -->
  <bean id="pwdChangeInputCommand" class="jp.co.transcosmos.dm3.adminCore.pwdChange.command.PwdChangeInputCommand" scope="prototype" />

  <!-- 管理ユーザーパスワード変更完了画面 -->
  <bean id="pwdChangeCompCommand" class="jp.co.transcosmos.dm3.adminCore.pwdChange.command.PwdChangeCompCommand" scope="prototype">
    <property name="userManager" ref="adminUserManager" />
  </bean>



  <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMappingList">
    <property name="commandURLMapper" ref="commandURLMapper"/>
    <property name="mappings">
      <list>
        <!-- 管理ユーザー検索・一覧画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/list/"/>
          <property name="namedCommands">
            <props>
              <prop key="list">adminUserListCommand</prop>
            </props>
          </property>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserList.jsp"/>
        </bean>

        <!-- CSV 出力 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/csv/"/>
          <property name="defaultCommandName" value="adminUserCsvCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserList.jsp"/>
          <property name="namedViews">
            <props>
              <prop key="success">csvh:adminUserCsvConfig</prop>
            </props>
          </property>
        </bean>

        <!-- 管理ユーザー新規入力画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/new/input/" />
          <property name="defaultCommandName" value="adminUserAddInputCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserAddInput.jsp"/>
        </bean>

        <!-- 管理ユーザー新規入力確認画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/new/confirm/" />
          <property name="defaultCommandName" value="adminUserAddConfirmCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserAddConfirm.jsp"/>
          <property name="namedViews">
            <props>
              <prop key="input">/WEB-INF/jsp/admin/userManage/AdmUserAddInput.jsp</prop>
            </props>
          </property>
        </bean>

        <!-- 管理ユーザー新規登録完了画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/new/result/" />
          <property name="defaultCommandName" value="adminUserAddCompCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserCompRedirect.jsp"/>
          <property name="namedViews">
            <props>
              <prop key="input">/WEB-INF/jsp/admin/userManage/AdmUserAddInput.jsp</prop>
              <prop key="comp">/WEB-INF/jsp/admin/userManage/AdmUserComp.jsp</prop>
            </props>
          </property>
        </bean>

        <!-- 管理ユーザー変更入力画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/update/input/" />
          <property name="defaultCommandName" value="adminUserUpdInputCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserUpdInput.jsp"/>
        </bean>

        <!-- 管理ユーザー変更入力確認画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/update/confirm/" />
          <property name="defaultCommandName" value="adminUserUpdConfirmCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserUpdConfirm.jsp"/>
          <property name="namedViews">
            <props>
              <prop key="input">/WEB-INF/jsp/admin/userManage/AdmUserUpdInput.jsp</prop>
            </props>
          </property>
        </bean>

        <!-- 管理ユーザー更新完了画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/update/result/" />
          <property name="defaultCommandName" value="adminUserUpdCompCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserCompRedirect.jsp"/>
          <property name="namedViews">
            <props>
              <prop key="input">/WEB-INF/jsp/admin/userManage/AdmUserUpdInput.jsp</prop>
              <prop key="comp">/WEB-INF/jsp/admin/userManage/AdmUserComp.jsp</prop>
            </props>
          </property>
        </bean>

        <!-- 管理ユーザー削除完了画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/delete/" />
          <property name="defaultCommandName" value="adminUserDelCompCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserCompRedirect.jsp"/>
          <property name="namedViews">
            <props>
              <prop key="comp">/WEB-INF/jsp/admin/userManage/AdmUserList.jsp</prop>
            </props>
          </property>
        </bean>

        <!-- 管理ユーザーロック解除画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/unlock/" />
          <property name="defaultCommandName" value="adminUserUnlockCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/userManage/AdmUserListDeleteCompRedirect.jsp"/>
        </bean>

        <!-- ランダムパスワードの生成（Web API） -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/admin/mkpwd/" />
          <property name="defaultCommandName" value="adminRandomPwdCommand"/>
          <property name="defaultViewName" value="json"/>
        </bean>

        <!-- パスワード変更入力画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/password/input/" />
          <property name="defaultCommandName" value="pwdChangeInputCommand"/>
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/pwdChange/PwdChangeInput.jsp"/>
        </bean>

        <!-- パスワード変更処理 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/password/change/" />
          <property name="defaultCommandName" value="pwdChangeCompCommand"/>
          <property name="defaultViewName" value="redirect:###!webroot###/top/password/result/"/>
          <property name="namedViews">
            <props>
              <prop key="input">/WEB-INF/jsp/admin/pwdChange/PwdChangeInput.jsp</prop>
            </props>
          </property>
        </bean>

        <!-- パスワード変更入力完了画面 -->
        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
          <property name="urlPattern" value="/top/password/result/" />
          <property name="defaultViewName" value="/WEB-INF/jsp/admin/pwdChange/PwdChangeComp.jsp"/>
        </bean>
      </list>
    </property>
  </bean>
</beans>
