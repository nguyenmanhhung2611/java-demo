<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:util="http://www.springframework.org/schema/util"
	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                           http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.2.xsd">

  <!-- マイページ会員新規登録入力画面 -->
  <bean id="memberAddInputCommand" class="jp.co.transcosmos.dm3.webFront.mypage.command.MemberInputCommand" scope="prototype">
    <property name="panamCommonManager" ref="panamCommonManager"/>
    <property name="userManager" ref="panaMypageUserManager"/>
    <property name="mode" value="insert"/>
  </bean>

  <!-- マイページ会員新規登録入力確認画面 -->
  <bean id="memberAddConfirmCommand" class="jp.co.transcosmos.dm3.webFront.mypage.command.MemberConfirmCommand" scope="prototype">
    <property name="userManager" ref="mypageUserManager"/>
  	<property name="panamCommonManager" ref="panamCommonManager"/>
    <property name="mode" value="insert"/>
  </bean>

  <!-- マイページ会員新規入力完了画面 -->
  <bean id="memberAddCompCommand" class="jp.co.transcosmos.dm3.webFront.mypage.command.MemberCompCommand" scope="prototype">
  	<property name="panamCommonManager" ref="panamCommonManager"/>
    <property name="userManager" ref="mypageUserManager"/>
    <property name="mode" value="insert"/>
    <property name="useUserIdValidation" value="false"/>
	<property name="sendMypagePasswordTemplate" ref="sendMemberAddTemplate"/>
  </bean>
  
  <!-- Member add final command bean -->
  <bean id="memberAddCompResultCommand" class="jp.co.transcosmos.dm3.webFront.mypage.command.MemberCompCommand" scope="prototype">
    <property name="mode" value="comp"/>
    <property name="useUserIdValidation" value="false"/>
  </bean>
  <!-- マイページ会員変更入力画面 -->
  <bean id="memberUpdInputCommand" class="jp.co.transcosmos.dm3.webFront.mypage.command.MemberInputCommand" scope="prototype">
    <property name="panamCommonManager" ref="panamCommonManager"/>
    <property name="userManager" ref="panaMypageUserManager"/>
    <property name="mode" value="update"/>
  </bean>

  <!-- マイページ会員変更入力確認画面 -->
  <bean id="memberUpdConfirmCommand" class="jp.co.transcosmos.dm3.webFront.mypage.command.MemberConfirmCommand" scope="prototype">
    <property name="userManager" ref="mypageUserManager"/>
  	<property name="panamCommonManager" ref="panamCommonManager"/>
    <property name="mode" value="update"/>
  </bean>

  <!-- マイページ会員変更完了画面 -->
  <bean id="memberUpdCompCommand" class="jp.co.transcosmos.dm3.webFront.mypage.command.MemberCompCommand" scope="prototype">
  	<property name="panamCommonManager" ref="panamCommonManager"/>
    <property name="userManager" ref="mypageUserManager"/>
    <property name="mode" value="update"/>
    <property name="sendMypagePasswordTemplate" ref="sendMemberAddTemplate"/>
  </bean>

  <!-- 住所取得 -->
	<bean id="getAddressByZipCommand"
		class="jp.co.transcosmos.dm3.webFront.mypage.command.GetAddressByZipCommand"
		scope="prototype">
		<property name="panamCommonManager" ref="panamCommonManager" />
	</bean>

	<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMappingList">
		<property name="commandURLMapper" ref="commandURLMapper" />
		<property name="mappings">
			<list>

				<!-- マイページ会員新規入力画面 -->
		        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		          <property name="urlPattern" value="/account/member/new/input/###refCd###/" />
		          <property name="defaultCommandName" value="memberAddInputCommand"/>
		          <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberAddInput.jsp"/>
		        </bean>
		        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		          <property name="urlPattern" value="/account/member/new/input/" />
		          <property name="defaultCommandName" value="memberAddInputCommand"/>
		          <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberAddInput.jsp"/>
		        </bean>

		        <!-- マイページ会員新規入力確認画面 -->
		        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		          <property name="urlPattern" value="/account/member/new/confirm/" />
		          <property name="defaultCommandName" value="memberAddConfirmCommand"/>
		          <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberAddConfirm.jsp"/>

		          <property name="namedViews">
		            <props>
		              <prop key="input">/WEB-INF/jsp/front/mypage/MemberAddInput.jsp</prop>
		            </props>
		          </property>
		        </bean>

				<!-- CSRF 対策用 token のチェックフィルター -->
<!-- フィルターの実行タイミングが固定できないので、global.xml へ移動
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/member/new/result/" />
					<property name="defaultCommandName" value="csrfChkFilter"/>
					<property name="filter" value="true"/>
				</bean>
-->

		        <!-- マイページ会員新規登録完了画面 -->
		        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		          <property name="urlPattern" value="/account/member/new/result/" />
		          <property name="defaultCommandName" value="memberAddCompCommand"/>
		          <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberCompRedirect.jsp"/>
		          <property name="namedViews">
		            <props>
		              <prop key="input">/WEB-INF/jsp/front/mypage/MemberAddInput.jsp</prop>
		            </props>
		          </property>
		        </bean>

				<!-- 住所検索 -->
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/account/member/new/zipToAddress/" />
					<property name="defaultCommandName" value="getAddressByZipCommand"/>
					<property name="defaultViewName" value="json"/>
				</bean>

		        <!-- 再ログイン処理 -->
		       <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		         <property name="urlPattern" value="/account/member/new/login/"/>
		         <property name="defaultCommandName" value="loginCommand"/>
		         <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberAddComp.jsp"/>
		         <property name="namedViews">
		           <props>
		             <prop key="success">redirect:###!redirectURL###</prop>
		           </props>
		         </property>
		       </bean>

		        <!-- マイページ会員新規登録完了画面 -->
		        <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		          <property name="urlPattern" value="/account/member/new/comp/"/>
		          <property name="defaultCommandName" value="memberAddCompResultCommand"/>
		          <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberAddComp.jsp"/>
		        </bean>

		       <!-- マイページ会員変更入力画面 -->
		       <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		         <property name="urlPattern" value="/mypage/member/change/input/" />
		         <property name="defaultCommandName" value="memberUpdInputCommand"/>
		         <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberUpdInput.jsp"/>
		       </bean>

		       <!-- マイページ会員変更入力確認画面 -->
		       <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		         <property name="urlPattern" value="/mypage/member/change/confirm/" />
		         <property name="defaultCommandName" value="memberUpdConfirmCommand"/>
		         <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberUpdConfirm.jsp"/>
		         <property name="namedViews">
		           <props>
		             <prop key="input">/WEB-INF/jsp/front/mypage/MemberUpdInput.jsp</prop>
		           </props>
		         </property>
		       </bean>

				<!-- CSRF 対策用 token のチェックフィルター -->
<!-- フィルターの実行タイミングが固定できないので、global.xml へ移動
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/mypage/member/change/result/" />
					<property name="defaultCommandName" value="csrfChkFilter"/>
					<property name="filter" value="true"/>
				</bean>
-->

		       <!-- マイページ会員更新完了画面 -->
		       <bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
		         <property name="urlPattern" value="/mypage/member/change/result/" />
		         <property name="defaultCommandName" value="memberUpdCompCommand"/>
		         <property name="defaultViewName" value="/WEB-INF/jsp/front/mypage/MemberUpdCompRedirect.jsp"/>
		         <property name="namedViews">
		           <props>
		              <prop key="input">/WEB-INF/jsp/front/mypage/MemberUpdInput.jsp</prop>
		              <prop key="comp">/WEB-INF/jsp/front/mypage/MemberUpdComp.jsp</prop>
		           </props>
		         </property>
		       </bean>

		        <!-- 住所取得（update） -->
				<bean class="jp.co.transcosmos.dm3.servlet.URLCommandViewMapping">
					<property name="urlPattern" value="/mypage/member/change/zipToAddress/" />
					<property name="defaultCommandName" value="getAddressByZipCommand"/>
					<property name="defaultViewName" value="json"/>
				</bean>

			</list>
		</property>
	</bean>

</beans>
